# 4 глава Основы

Оборудование, продаваемое как сервер, качественно отличается от оборудования, приобретаемого для индивидуальной рабочей станции. У серверного оборудования другие возможности, а при его разработке учитывается другая экономическая модель. При установке и поддержке серверов используются особые
процедуры. Как правило, серверы поставляются с контрактом на обслуживание,
системами резервного копирования, операционной системой и возможностью
удаленного доступа. Кроме того, серверы размещают в вычислительных центрах
с контролируемым микроклиматом и с ограниченным доступом к серверному
оборудованию. Понимание этих различий поможет вам в принятии верного
решения при закупке.

## Покупайте для серверов серверное оборудование
Серверные системы отличаются от клиентских или настольных систем. Покупка настольного компьютера и установка на него серверного программного обеспечения может быть короткосрочным решением, но не подходит для долгосрочных или крупных проектов. Серверное оборудование обычно стоит дороже, но имеет расширяемость, высокую производительность процессоров, высокопроизводительные системы обмена информацией (ввода-вывода), возможности модернизации и возможность монтирования в стойку.

Дизайн сервера, который соответствует выделенному ему месту, имеет ряд важных особенностей:

1. Выбор разъемов: При выборе разъемов необходимо учитывать размещение в стойках и оптимальное подключение. Например, для подключения последовательных консолей рекомендуется использовать стандартный патч-кабель категории 5, вместо разъемов db-9 с винтами.

2. Удобство обслуживания: Компьютер должен быть установлен в стойку таким образом, чтобы его ремонт и обслуживание были проще. Это означает, что все кабели должны быть сзади, а все отсеки приводов и дисков – спереди, чтобы не требовался доступ к боковым стенкам машины.

3. Доступность с одной стороны: Некоторые системы требуют доступа только с одной стороны. При размещении устройства в тесном шкафу важно учитывать возможность обслуживания, несмотря на ограниченный доступ.

4. Встроенные функции для повышения надежности: Многие серверы обладают дополнительными возможностями, такими как дублированные источники питания, RAID, несколько сетевых карт и компоненты с поддержкой "горячей" замены, которые повышают надежность работы сервера.

5. Контракт на обслуживание: Поставщики оборудования предлагают контракты на обслуживание, в которых оговариваются гарантийные сроки замены запасных частей.

6. Удаленное управление: Идеально, если серверы имеют функции удаленного управления, такие как доступ через последовательный порт и встроенные сенсоры температуры, позволяющие генерировать оповещения о проблемах и удаленно диагностировать и восстанавливать сбойное оборудование.

7. Улучшение конструкции серверов: Поставщики постоянно улучшают дизайн серверов, чтобы удовлетворить потребности бизнеса. Влияние рынка заставляет их приспосабливаться под колокейшн-центры, поэтому серверы становятся компактнее и оптимизированными для экономии площади. Возможности дистанционного управления играют важную роль в минимизации времени простоя при обслуживании серверов в таких центрах.

колокейшнцентр – арендуемый вычислительный центр, где оплата идет за единицу
площади.

## Выбирайте поставщиков, известных надежностью продукции
Важно выбирать надежных поставщиков. Некоторые используют компоненты потребительского класса, другие соответствуют военному стандарту MIL-SPEC. Опытные поставщики предлагают дополнительные возможности и техническое обслуживание. Можно обратиться к системным администраторам для рекомендаций по поставщикам. Оборудование может быть однотипным или разнотипным. Однотипное оборудование проще обслуживать, но разнотипное обеспечивает лучшее обслуживание за счет конкуренции.

## Реальные расходы на серверное оборудование
Для понимания дополнительных расходов на серверы важно знать состав компьютеров. Большинство поставщиков предлагают три серии продукции: для дома, для бизнеса и серверное оборудование. Домашние компьютеры продаются по наименьшей цене, но при необходимости дополнений стоимость возрастает. Компоненты описываются общими характеристиками, не указывая конкретные производители и модели. Это связано с тем, что поставщики меняют компоненты, чтобы сохранить низкую цену. Домашние компьютеры обычно содержат дополнения для игр. 

Компьютеры для бизнеса разрабатываются с учетом общих затрат на всем протяжении службы. Начальная цена выше, но такие компьютеры не устаревают так быстро. Бизнес-серии редко содержат новейшие компоненты, чтобы избежать затрат на обучение техников по ремонту разных моделей. 

Серверы ориентированы на соотношение между себестоимостью и производительностью. Тесты определяют минимальную стоимость производительности сервера. Некоторые возможности серверов увеличивают цену, но повышают надежность работы. 

Серверы стоят дороже из-за удобного корпуса и ограничений на его размещение, что облегчает обслуживание и ремонт. Неверно сравнивать цены серверов и настольных компьютеров, потому что они различаются в своих функциях и характеристиках.
Дороговизну серверного оборудования можно обосновать следующим образом:

1. Высокая производительность: Серверы предназначены для выполнения сложных задач и обработки большого объема данных. Поэтому они оснащены более мощными процессорами, большим объемом оперативной памяти и другими компонентами, которые обеспечивают высокую производительность. Это необходимо для обработки миллионов транзакций в день или распределения мощности процессора между десятками пользователей. Более высокая производительность требует использования более дорогих компонентов и технологий, поэтому стоимость сервера значительно выше, чем у персонального компьютера.

2. Надежность и отказоустойчивость: Серверы работают непрерывно и обеспечивают доступность сервисов для пользователей или клиентов. Любые простои в работе сервера могут привести к значительным финансовым потерям или потере доверия со стороны пользователей. Поэтому серверное оборудование обычно оснащено дополнительными компонентами, такими как дублирующие блоки питания, резервные жесткие диски и возможность горячей замены компонентов. Эти функции позволяют минимизировать потери производительности и простои сервера, но требуют дополнительных затрат на оборудование.

3. Долгосрочные инвестиции: Покупка дорогого сервера с запасом производительности может отсрочить необходимость модернизации в будущем. С течением времени требования к производительности могут возрастать, и сервер с высокой производительностью может сохранить свою актуальность на протяжении более длительного периода времени. Таким образом, дополнительные расходы на дорогой сервер могут окупиться за счет отсутствия необходимости в дорогостоящей модернизации в будущем.

В целом, дороговизна серверного оборудования объясняется его высокой производительностью, надежностью и долгосрочной эффективностью. Een серверные системы представляют собой критически важные компоненты для бизнеса, и дополнительные затраты на надежное оборудование могут быть полностью оправданы.

## Контракты на обслуживание и запасные компоненты

При покупке сервера учитывайте возможность ремонта. Поставщики предлагают различные контракты на обслуживание, включая выбор срока обслуживания заявок и возможность пополнять комплект запасных частей. 
Некритически важные серверы могут обслуживаться на следующий день или через два дня, либо иметь стандартное гарантийное обслуживание. 
Если у вас много однотипных серверов, может быть полезно приобрести комплект запасных частей и производить ремонт самостоятельно. 
При постепенной модернизации, со временем может потребоваться замена устаревших моделей на новые, для которых нет запасных частей. В этом случае можно стандартизировать срок обеспечения запасными частями и приобрести их по мере необходимости. 
Для важных узлов может быть разумно хранить запасные части только для часто выходящих из строя компонентов и заключить контракт на обслуживание для остальных. 
Если у вас есть много моделей от одного поставщика, можно договориться о выделении техника для работы в сети компании или создание склада запасных частей. 
Системному администратору могут предоставить место в офисе и телефон в обмен на предоставление технической поддержки.

## Обеспечение целостности данных
Сервера хранят критические данные и конфигурации, нуждающиеся в защите. Клиентские рабочие станции обычно имеют однотипные конфигурации и данные хранятся на серверах, что устраняет необходимость в резервном копировании. В случае сбоя диска на рабочей станции, конфигурация должна быть идентичной другим машинам и может быть восстановлена автоматически. Однако, люди все же хранят данные на локальных машинах, устанавливают программы локально, и операционная система также хранит некоторые конфигурационные данные локально. На Windows-платформах невозможно избежать этого. Переносимые профили могут сохранять пользовательские настройки на сервере, но не защищают локально установленное программное обеспечение и настройки реестра. UNIX-системы менее подвержены этому, так как грамотно настроенная система защищает локальный диск от записи, кроме нескольких специфических файлов.

## Размещение серверов в вычислительном центре
Серверы должны быть установлены в надежных условиях, включая надежное энергоснабжение, противопожарную защиту, сеть, охлаждение и физическую безопасность. Желательно зарезервировать физическое место для сервера заранее и использовать метки для предотвращения повторной резервации. Для разметки мест энергоснабжения и охлаждения следует использовать список или таблицу. После сборки оборудования сервер лучше устанавливать в стойку непосредственно перед установкой операционной системы и другого программного обеспечения. Важно учитывать, что установка сервера в офисе без надлежащей защиты может привести к проблемам в будущем. Лучше всего установить сервер в его конечном местоположении как можно скорее после его сборки. Важно иметь выделенную комнату или шкаф для обеспечения физической безопасности, надежного источника питания и достаточного охлаждения. Лучше всего приобрести шкаф для телекоммуникационной аппаратуры с хорошим охлаждением и замком, чем использовать сервер, стоящий у кого-то под столом. Также можно выбрать недорогую систему охлаждения, которая не требует отвода и повторного испарения воды через вентиляционные отверстия.

## Конфигурация клиент серверной ОС
Серверы могут иметь отличные ОС от клиентов и быть настроенными по-разному в зависимости от своего назначения. Например, веб-серверу не обязательно использовать ту же ОС, что и клиенты, главное - одинаковый протокол. На специализированных сетевых устройствах, таких как файл-серверы, веб-серверы и почтовые серверы, обычно установлена мини-ОС с необходимым программным обеспечением.

Бывают случаи, когда на серверах требуется установить те же программы, что и на клиентах. Например, в UNIX-сетях с множеством компьютеров под управлением UNIX и многопроцессорными серверами, клиентам следует устанавливать одинаковую клонированную ОС, а серверам - ту же ОС, но с другой конфигурацией.

Серверные ОС, такие как Solaris 2.x и Red Hat Linux, ориентированы на перспективу. Например, Solaris 2.x может быть установлен на сервере, чтобы бездисковые клиенты или машины с малым объемом жестких дисков могли загружать необходимые программные пакеты с сервера через NFS. С другой стороны, установка Red Hat Linux на сервере включает только базовую конфигурацию, которую можно дополнить специализированными пакетами для создания служб. Этот подход становится более популярным с ростом объема жестких дисков.

## Обеспечьте удаленный доступ через консоль
Для серверов необходимо удаленное обслуживание. Раньше каждый сервер имел свою собственную консоль: клавиатуру, видеомонитор или консольный вывод на печать и, возможно, мышь. Однако с появлением переключателей КВМ можно использовать одну клавиатуру, видеоэкран и мышь для нескольких серверов. Это позволяет установить больше серверов в ограниченном пространстве. Еще больше места можно сэкономить с помощью IP-КВМ, которые позволяют удаленное управление без использования клавиатуры, монитора и мыши. Также существуют последовательные консоли и переключатели КВМ, которые позволяют управлять системой, даже если сеть не работает или система неисправна. Некоторые поставщики также предлагают карты расширения для удаленного управления серверами. Удаленные консольные системы также имитируют специальные сочетания клавиш для выполнения определенных функций.
Важно отметить, что использование удаленной консоли для доступа к серверам и другому оборудованию имеет свои плюсы и минусы. С одной стороны, это позволяет удобно и эффективно управлять системой из любой точки мира, что особенно полезно для профессионалов, которые занимаются обслуживанием и управлением большого количества серверов и компьютеров. Они могут удаленно управлять системой, не требуя физического присутствия на месте.

С другой стороны, удаленный доступ может быть уязвим для внешних угроз и злоумышленников. Если удаленный доступ не обеспечен должным образом, это может представлять угрозу для безопасности системы. Поэтому очень важно обеспечить аутентификацию и конфиденциальность удаленного доступа.

Один из способов сделать удаленный доступ безопасным - использовать шифрованные каналы, такие как SSH, для передачи данных между удаленной консолью и сервером. Это помогает защитить информацию от перехвата и злоупотреблений. Также можно внедрить дополнительные способы аутентификации, такие как системы одноразовых паролей или считыватели отпечатков пальцев, чтобы убедиться, что только авторизованные пользователи имеют доступ к удаленной консоли.

При выборе сервера и другого оборудования также стоит обратить внимание на наличие возможности удаленного консольного доступа. Если поставщик не предлагает эту опцию, то стоит искать другие варианты, так как удаленный доступ может быть очень полезным и удобным инструментом для управления системой.

## Зеркалирование загрузочных дисков
Загрузочный диск, или диск с операционной системой, как правило, заменить сложно в случае повреждения. Для ускорения процесса восстановления необходимо создать зеркальный диск для загрузочного диска каждого сервера. RAID 1 позволяет обновлять два диска одновременно и автоматически переключаться на работоспособный диск при отказе одного из них. Зеркалирование снижает производительность при записи, но увеличивает скорость чтения. В случае отказа жесткого диска, зеркальное копирование обеспечивает безопасность данных и позволяет заменить диск без простоя системы. Однако, зеркальное копирование не защищает от программных или пользовательских ошибок. Поэтому резервное копирование также необходимо. Программная ошибка, связанная с различием в использовании указателя памяти, может привести к повреждению зеркала и простою системы, что может иметь негативные последствия для компании.
Чтобы вернуться к исправному и известному состоянию, необходимо выполнить следующие шаги:

1. Определите, что находится в исправном и известном состоянии. Это может быть физическое устройство, программное обеспечение, процесс или что-то еще.

2. Идентифицируйте проблемы или изменения, которые привели к отклонению от исправного состояния. Это могут быть ошибки, сбои, несовместимость или другие факторы.

3. Проанализируйте причины этих проблем и определите, как их исправить. Это может включать в себя отладку, откат до предыдущей версии, восстановление данных или другие корректирующие действия.

4. Разработайте план восстановления, который определяет необходимые шаги и последовательность действий для возвращения к исправному состоянию. Убедитесь, что план хорошо продуман и при необходимости привлеките специалистов или ресурсы.

5. Приступите к реализации плана восстановления. Следуйте определенным шагам и проверьте результаты на каждом этапе.

6. Проверьте восстановленное состояние, чтобы убедиться, что все работает должным образом. Проведите тестирование, проверку и контрольные точки, чтобы удостовериться, что проблемы были решены и система функционирует надежно.

7. Установите механизмы мониторинга и контроля, чтобы предотвратить повторение проблем и реагировать на них в случае необходимости.

8. Оцените причины возникновения проблем и принявшиеся меры, чтобы предпринять шаги по их предотвращению в будущем.

9. Документируйте весь процесс восстановления. Это поможет вам и вашей команде в будущих случаях или для обучения других.

10. Поддерживайте исправное состояние регулярным обслуживанием, обновлениями и мерами предотвращения. Уделите внимание проактивной работе по обнаружению и устранению возможных проблем до их появления.

Изменение состояния может быть сложным процессом, и, возможно, потребуется время и усилия, чтобы вернуться к исправному и известному состоянию. Однако, следуя этим шагам и используя правильные инструменты и подходы, вы можете успешно достичь своей цели.

# Тонкости Повышение надежности и удобства обслуживания
## Повышение надежности и удобства обслуживания
### Одноцелевые серверы
Одноцелевые устройства имеют преимущества перед универсальными устройствами в выполнении специфических задач. В компьютерном мире примерами таких устройств являются файловые серверы, веб-серверы, серверы электронной почты, DNS-серверы и т.д. Одноцелевое устройство позволяет более качественно выполнять одну задачу, чем универсальный компьютер, и не требует прерывания работы сети при перезагрузке. Создание одноцелевого сервера требует сложного конструирования и системного проектирования. Приобретение одноцелевых устройств упрощает настройку и поддержку систем, сокращает время системного администратора и обеспечивает надежность. Также одноцелевые устройства предлагают уникальные возможности, такие как настраиваемые снимки файловой системы для устранения потери данных.

### Резервные блоки питания
Блоки питания являются вторыми по предрасположенности к сбоям после жестких дисков. Для обеспечения работы системы при выходе из строя одного из блоков питания необходима избыточность n + 1, что означает наличие резервных блоков. В некоторых случаях требуется использование двух или трех блоков питания для достаточной мощности. Поставщики не всегда информируют об этом. Каждый блок питания должен иметь отдельный кабель. При подключении нескольких блоков питания рекомендуется использовать отдельные источники электропитания, например UPS. Это обеспечит работоспособность системы при возникновении сбоев в отдельных источниках электропитания. У Тома возникла ситуация, когда необходимо было отключить UPS, но при этом сохранить работу маршрутизатора. Благодаря наличию резервного блока питания и отдельному кабелю питания, маршрутизатор продолжал функционировать без простоев, используя розетку без UPS.

### Полная избыточность, или n + 1
Избыточность n + 1 – это системы, которые продолжают работать после сбоя одного из компонентов. Примеры таких систем: RAID-массивы и коммутаторы Ethernet с многовходовой системой коммутации. 

При полной избыточности два набора оборудования объединяются в отказоустойчивую конфигурацию. 

Другие системы с полной избыточностью используют распределение нагрузки. Каждый сервер может взять на себя всю нагрузку, если другая система отказывает. 

Если n ≥ 2, то избыточность n + 1 предпочтительнее полной избыточности из-за экономичности. 

Избыточность n + 1 обычно используется только для серверных подсистем. Важно проверить, что все части системы являются резервными, а не только некоторые.

### Компоненты, поддерживающие «горячую» замену
Резервные компоненты должны поддерживать "горячую" замену, то есть быть заменяемыми во время работы системы. Главное преимущество "горячей" замены заключается в возможности замены компонента без отключения системы. Это особенно важно при сбоях, чтобы нейтрализовать риск двойного сбоя компонентов. Чем быстрее замена, тем лучше, чтобы система вернулась в полную работоспособность. Компоненты с "горячей" заменой повышают стоимость системы, но это оправдано, если устранение простоев стоит дополнительных затрат. Поставщики должны указывать на компоненты без возможности "горячей" замены и на прерывания работы при замене компонентов. Возможность "горячей" замены уменьшает продолжительность простоев в работе, но не устраняет их полностью.
Однако, важно отметить, что не все компоненты поддерживают "горячую" замену. Это должно быть указано на ярлыке компонента или в его документации. Если вы не можете найти такую информацию, лучше всего обратиться к поставщику или производителю компонента для уточнения этого вопроса.

Если компонент не поддерживает "горячую" замену, вам необходимо выключить систему, подключить компонент, а затем снова включить систему. Это может привести к простою в работе системы на некоторое время, поэтому рекомендуется планировать такие работы заранее, чтобы минимизировать влияние на работу системы.

Когда вы подключаете новый компонент, особенно если он заменяет существующий компонент, всегда важно оценить возможные риски и последствия. Перед подключением компонента ознакомьтесь с инструкциями и рекомендациями по его установке. Также рекомендуется иметь резервные копии данных и проверить совместимость нового компонента с вашей системой.

В целом, "горячая" замена может быть удобным и безопасным способом обновления и замены компонентов в работающей системе, но всегда необходимо знать и учитывать ограничения и требования каждого конкретного компонента.

### Раздельные сети для административных функций
Дополнительные сетевые интерфейсы на серверах создают отдельную сеть для резервного копирования и мониторинга. Это позволяет разделить трафик и не мешать пользователем основной сети. Для этой отдельной сети используется простое оборудование, что делает ее надежной. Также она позволяет системным администраторам получать доступ во время простоя основной сети. Это решение специфической проблемы избыточности.

## Альтернатива: множество недорогих серверов
В итоге, отсутствие предвидения и организации привело к проблемам с доступом и управлением серверами, которые могли быть избежаны с помощью более внимательного анализа потребностей и установления строгих правил и ограничений. Таким образом, было бы лучше в начале проекта учесть и предусмотреть все возможные сценарии использования и управления приложением, чтобы обеспечить более эффективное и удобное управление системой.
ческое резервное копирование не было возможным. Разработчики были вынуждены обратиться к системным администраторам, которые обеспечивали удаленный доступ к каждому серверу через консоль. Это потребовало дополнительных затрат на обслуживание и управление системой. Также возникли проблемы с масштабируемостью и гибкостью, так как при добавлении новых блейд-плат требовалось переписывать код приложения и настраивать новые серверы. В итоге, начальное преимущество блейд-серверов было утрачено из-за сложностей в управлении и поддержке.
Вместо экономии на серверном оборудовании мы рекомендуем использовать несколько недорогих серверов, которые могут давать сбои чаще, но с механизмом распределения нагрузки, чтобы обеспечить высокую производительность и надежность. Это может быть выгоднее, особенно при запуске крупной веб-фермы. Если вы используете компоненты худшего качества, вы можете компенсировать их сбои, добавив еще несколько серверов. В начале 1990-х годов стоимость серверов была высокой, но к концу десятилетия они стали более доступными, благодаря массовому производству компонентов для персональных компьютеров. Крупные компании нашли способы управления большим количеством серверов и снизили затраты. Таким образом, использование нескольких недорогих серверов может быть более эффективным, чем покупка одного дорогого сервера. Оптимизация требований к оборудованию также способствует снижению затрат.

# Заключение
Покупая серверы, мы должны учитывать иные экономические факторы, чем при покупке настольных компьютеров. Важно иметь знание этих факторов, чтобы принимать грамотные решения при покупке. Также необходимо обеспечить обслуживание, резервное копирование и восстановление данных на серверах. Важно распределить пространство в машинном зале и спланировать электросеть, пропускную способность сети и систему охлаждения заранее. Одноцелевые серверы являются надежными и простыми в управлении, но сложно настраивать для нетипичных требований корпоративной сети. Серверам нужна возможность удаленного администрирования. Для повышения надежности серверов часто используются дополнительные системы. Грамотное решение всех этих вопросов важно для повышения надежности системы и упрощения обслуживания и восстановления.